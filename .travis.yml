language: python
python:
  - 3.6
services:
  - docker

script:
  - ./run_tests.sh

after_script:
  - codecov

before_deploy:
    - git tag $(grep -i version ouroboros/__init__.py | cut -d= -f2)

deploy:
  skip_cleanup: true
  - provider: script
    script: bash ./deploy.sh
    on:
      branch: master
  - provider: releases
    api_key: $github_api_key
    on:
      branch: master
      tags: true
